# Internationalization (i18n)

## HTML Language Setup

```html
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Language" content="ar" />
    <!-- Hreflang for all language versions -->
    <link rel="alternate" hreflang="en" href="https://example.com/en/page" />
    <link rel="alternate" hreflang="ar" href="https://example.com/ar/page" />
    <link
      rel="alternate"
      hreflang="x-default"
      href="https://example.com/en/page"
    />
  </head>
</html>
```

## RTL Layout (Logical Properties)

```css
/* ❌ WRONG: Physical properties */
.card {
  margin-left: 1rem;
  padding-right: 2rem;
  text-align: left;
  border-left: 2px solid blue;
}

/* ✅ CORRECT: Logical properties */
.card {
  margin-inline-start: 1rem;
  padding-inline-end: 2rem;
  text-align: start;
  border-inline-start: 2px solid blue;
}
```

### Logical Properties Reference

| Physical           | Logical               |
| ------------------ | --------------------- |
| `left`             | `inset-inline-start`  |
| `right`            | `inset-inline-end`    |
| `margin-left`      | `margin-inline-start` |
| `padding-right`    | `padding-inline-end`  |
| `text-align: left` | `text-align: start`   |

## ICU Message Format

```typescript
// ❌ WRONG: String concatenation
const message =
  "Hello " +
  username +
  "! You have " +
  (count === 1 ? "1 item" : count + " items");

// ✅ CORRECT: ICU Message Format
const messages = {
  greeting: "Hello {username}!",
  "item-count":
    "{count, plural, =0 {No items} =1 {1 item} other {{count} items}}",
};
```

## Date/Time/Number Formatting

```typescript
const locale = navigator.language; // e.g., "de-DE"

// Date
const dateFormatter = new Intl.DateTimeFormat(locale, {
  year: "numeric",
  month: "long",
  day: "numeric",
});
dateFormatter.format(new Date()); // "5. Dezember 2024"

// Number
const numberFormatter = new Intl.NumberFormat(locale, {
  style: "decimal",
  minimumFractionDigits: 2,
});
numberFormatter.format(1234567.89); // "1.234.567,89"

// Currency
const currencyFormatter = new Intl.NumberFormat(locale, {
  style: "currency",
  currency: "EUR",
});
currencyFormatter.format(1234.56); // "1.234,56 €"

// Relative time
const rtf = new Intl.RelativeTimeFormat(locale, { numeric: "auto" });
rtf.format(-1, "day"); // "gestern" (yesterday)
```

## Multi-Script Font Stack

```css
:root {
  --font-family-sans:
    "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
    /* Japanese */ "Hiragino Kaku Gothic ProN", "Yu Gothic", "Meiryo",
    /* Chinese */ "PingFang SC", "Microsoft YaHei",
    /* Korean */ "Malgun Gothic", /* Arabic */ "Geeza Pro", "Simplified Arabic",
    sans-serif;
}

/* Script-specific adjustments */
:lang(ja),
:lang(zh),
:lang(ko) {
  line-height: 1.7;
  font-size: 1.05em;
}

:lang(ar),
:lang(he) {
  line-height: 1.8;
}
```

## Locale Detection

```typescript
function detectLocale(
  supportedLocales: string[],
  defaultLocale: string,
): string {
  // 1. Check stored preference
  const stored = localStorage.getItem("locale");
  if (stored && supportedLocales.includes(stored)) return stored;

  // 2. Check URL path (/en/, /ar/)
  const pathLocale = window.location.pathname.split("/")[1];
  if (supportedLocales.includes(pathLocale)) return pathLocale;

  // 3. Check browser languages
  for (const browserLang of navigator.languages) {
    if (supportedLocales.includes(browserLang)) return browserLang;
    const langOnly = browserLang.split("-")[0];
    const match = supportedLocales.find((l) => l.startsWith(langOnly));
    if (match) return match;
  }

  return defaultLocale;
}
```

## RTL Icon Mirroring

```css
:dir(rtl) .icon-arrow-right {
  transform: scaleX(-1);
}
```

## i18n Checklist

- [ ] `lang` and `dir` on `<html>`
- [ ] Hreflang tags for all languages
- [ ] All layout uses logical properties
- [ ] ICU Message Format for plurals
- [ ] `Intl.DateTimeFormat` for dates
- [ ] `Intl.NumberFormat` for numbers/currency
- [ ] Font stack includes multi-script fallbacks
- [ ] RTL layouts tested
- [ ] 40% text expansion space reserved
